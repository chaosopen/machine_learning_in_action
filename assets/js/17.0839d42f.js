(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{377:function(_,t,s){_.exports=s.p+"assets/img/mae.44f65c9b.png"},378:function(_,t,s){_.exports=s.p+"assets/img/mse.17b0361a.png"},379:function(_,t,s){_.exports=s.p+"assets/img/rmse.aad86cfb.png"},380:function(_,t,s){_.exports=s.p+"assets/img/rmse2.adaaddcf.png"},381:function(_,t,s){_.exports=s.p+"assets/img/rmse3.bfa9e5d5.png"},382:function(_,t,s){_.exports=s.p+"assets/img/r2.45c875cc.png"},383:function(_,t,s){_.exports=s.p+"assets/img/r2_2.dd1f231a.png"},384:function(_,t,s){_.exports=s.p+"assets/img/r2_3.8a6e7e30.png"},385:function(_,t,s){_.exports=s.p+"assets/img/adjr.d095f5e1.png"},386:function(_,t,s){_.exports=s.p+"assets/img/adjr2.e9367010.png"},387:function(_,t,s){_.exports=s.p+"assets/img/adjr_r.cfd13daa.png"},428:function(_,t,s){"use strict";s.r(t);var a=s(14),v=Object(a.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"_4-3-回归问题评估"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-回归问题评估"}},[_._v("#")]),_._v(" 4.3 回归问题评估")]),_._v(" "),t("p",[_._v("MAE、MSE和RMSE，是不同于类别预测，不能苛刻回归预测的数值结果要严格的和真实值一致。一般情况下，我们希望衡量预测值和真实值之间的差距。因此，可以通过多种测评函数进行评价。")]),_._v(" "),t("h2",{attrs:{id:"_4-3-1-平均绝对误差"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-平均绝对误差"}},[_._v("#")]),_._v(" 4.3.1 平均绝对误差")]),_._v(" "),t("p",[t("strong",[_._v("Mean Absolute Error (MAE)")])]),_._v(" "),t("p",[t("img",{attrs:{src:s(377),alt:"img"}})]),_._v(" "),t("ul",[t("li",[t("p",[_._v("上面的公式中：n 为样本数量, y 为实际值, $\\hat{y}$ 为预测值")])]),_._v(" "),t("li",[t("p",[_._v("MAE 越小模型预测约准确")])])]),_._v(" "),t("p",[_._v("Sklearn 中MAE的API")]),_._v(" "),t("div",{staticClass:"language-python extra-class"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("from")]),_._v(" sklearn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(".")]),_._v("metrics "),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("import")]),_._v(" mean_absolute_error\nmean_absolute_error"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("y_test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("y_predict"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v("\n")])])]),t("h2",{attrs:{id:"_4-3-2-均方误差"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-均方误差"}},[_._v("#")]),_._v(" 4.3.2 均方误差")]),_._v(" "),t("p",[t("strong",[_._v("Mean Squared Error (MSE)")])]),_._v(" "),t("p",[t("img",{attrs:{src:s(378),alt:"img"}})]),_._v(" "),t("ul",[t("li",[_._v("上面的公式中：n 为样本数量, y 为实际值, $\\hat{y}$ 为预测值")]),_._v(" "),t("li",[_._v("MSE 越小模型预测约准确")])]),_._v(" "),t("p",[_._v("Sklearn 中MSE的API")]),_._v(" "),t("div",{staticClass:"language-python extra-class"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("from")]),_._v(" sklearn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(".")]),_._v("metrics "),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("import")]),_._v(" mean_squared_error\nmean_squared_error"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("y_test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("y_predict"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v("\n")])])]),t("h2",{attrs:{id:"_4-3-3-均方根误差"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-均方根误差"}},[_._v("#")]),_._v(" 4.3.3 均方根误差")]),_._v(" "),t("p",[t("strong",[_._v("Root Mean Squared Error (RMSE)")])]),_._v(" "),t("p",[t("img",{attrs:{src:s(379),alt:"img"}})]),_._v(" "),t("ul",[t("li",[t("p",[_._v("上面的公式中：n 为样本数量, y 为实际值, $\\hat{y}$ 为预测值")])]),_._v(" "),t("li",[t("p",[_._v("RMSE 越小模型预测约准确")])]),_._v(" "),t("li",[t("p",[_._v("RMSE 是 MSE 的平方根。某些情况下比MES更有用，由于 MAE 和 RMSE 都是误差的一次方，可以将它们相互比较")])])]),_._v(" "),t("h2",{attrs:{id:"_4-3-4-三种指标的比较"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-4-三种指标的比较"}},[_._v("#")]),_._v(" 4.3.4 三种指标的比较")]),_._v(" "),t("p",[_._v("看下面的例子")]),_._v(" "),t("p",[_._v("我们绘制了一条直线 "),t("strong",[_._v("y = 2x +5")]),_._v(" 用来拟合 "),t("strong",[_._v("y = 2x + 5 + e.")]),_._v(" 这些数据点，其中e为噪声")]),_._v(" "),t("p",[t("img",{attrs:{src:s(380),alt:"img"}})]),_._v(" "),t("p",[_._v("从上图中我们发现 MAE 和 RMSE 非常接近，都表明模型的误差很低（MAE 或 RMSE 越小，误差越小！）。 但是MAE 和 RMSE 有什么区别？为什么MAE较低？")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("对比MAE 和 RMSE的公式，RMSE的计算公式中有一个平方项，因此：大的误差将被平方，因此会增加 RMSE 的值")])]),_._v(" "),t("li",[t("p",[_._v("可以得出结论，RMSE 会放大预测误差较大的样本对结果的影响，而 MAE 只是给出了平均误差")])]),_._v(" "),t("li",[t("p",[_._v("由于 RMSE 对误差的 "),t("strong",[_._v("平方和求平均")]),_._v(" 再开根号，大多数情况下RMSE>MAE")]),_._v(" "),t("p",[_._v("举例 (1+3)/2 = 2   $\\sqrt{(1^2+3^2)/2 }= \\sqrt{10/2} = \\sqrt{5} = 2.236$")])])]),_._v(" "),t("p",[_._v("我们再看下一个例子")]),_._v(" "),t("p",[t("img",{attrs:{src:s(381),alt:"img"}})]),_._v(" "),t("p",[_._v("橙色线与第一张图中的直线一样："),t("strong",[_._v("y = 2x +5")])]),_._v(" "),t("p",[_._v("蓝色的点为： "),t("strong",[_._v("y = y + sin(x)*exp(x/20) + e")]),_._v("  其中 exp() 表示指数函数")]),_._v(" "),t("p",[_._v("我们看到对比第一张图，所有的指标都变大了，RMSE 几乎是 MAE 值的两倍，因为它对预测误差较大的点比较敏感")]),_._v(" "),t("p",[_._v("我们是否可以得出结论： RMSE是更好的指标？ 某些情况下（希望将小误差与大误差一样对待）MAE更有优势，例如：")]),_._v(" "),t("ul",[t("li",[_._v("假设数据中有少数异常点偏差很大，如果此时根据 RMSE 选择线性回归模型，可能会选出过拟合的模型来")]),_._v(" "),t("li",[_._v("在这种情况下，由于数据中的异常点极少，选择具有最低 MAE 的回归模型可能更合适")]),_._v(" "),t("li",[_._v("除此之外，当两个模型计算RMSE时数据量不一致，也不适合在一起比较")])]),_._v(" "),t("h2",{attrs:{id:"_4-3-5-mae-mse-and-rmse小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-5-mae-mse-and-rmse小结"}},[_._v("#")]),_._v(" 4.3.5 MAE, MSE and RMSE小结")]),_._v(" "),t("p",[_._v("一般我们使用MAE 和 RMSE 这两个指标")]),_._v(" "),t("h3",{attrs:{id:"_1-mae、rmse的优点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-mae、rmse的优点"}},[_._v("#")]),_._v(" 1. MAE、RMSE的优点")]),_._v(" "),t("ul",[t("li",[_._v("都能反映出预测值和真实值之间的误差")]),_._v(" "),t("li",[_._v("MAE反应的是“真实”的平均误差，RMSE会将误差大的数据点放大")])]),_._v(" "),t("h3",{attrs:{id:"_2-mae、rmse的缺点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-mae、rmse的缺点"}},[_._v("#")]),_._v(" 2. MAE、RMSE的缺点")]),_._v(" "),t("ul",[t("li",[_._v("MAE 不能体现出误差大的数据点，RMSE虽然会加放大大误差的数据点对指标的影响， 但是对异常数据比较敏感")])]),_._v(" "),t("h2",{attrs:{id:"_4-3-6-r-squared-和-adj-r2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-6-r-squared-和-adj-r2"}},[_._v("#")]),_._v(" 4.3.6 R-Squared 和 Adj. R²")]),_._v(" "),t("h3",{attrs:{id:"_1-r-squared-r2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-r-squared-r2"}},[_._v("#")]),_._v(" 1. R-Squared (R²)")]),_._v(" "),t("p",[t("img",{attrs:{src:s(382),alt:"img"}})]),_._v(" "),t("p",[_._v("上面的公式中y = 真实值, $\\hat{y}$  = 模型预测值, $\\bar{y}$  = 真实值的平均值")]),_._v(" "),t("p",[_._v("Sklearn 中R-Squared 的API")]),_._v(" "),t("div",{staticClass:"language-python extra-class"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("from")]),_._v(" sklearn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(".")]),_._v("metrics "),t("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("import")]),_._v(" r2_score\nr2_score"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("(")]),_._v("y_test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("y_predict"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(")")]),_._v("\n")])])]),t("p",[_._v("R²代表了预测值和真实值拟合的拟合程度，既考虑了预测值与真实值的差异，同时也兼顾了真实值的离散程度")]),_._v(" "),t("ul",[t("li",[_._v("R²<0.5 → 弱拟合")]),_._v(" "),t("li",[_._v("0.5 ≤ R² ≤ 0.8 → 中度拟合")]),_._v(" "),t("li",[_._v("R² > 0.8 强拟合")])]),_._v(" "),t("blockquote",[t("p",[_._v("注意：理论上 R² < 0 是可能的，但是只出现在模型特别差的情况，因此不予讨论")])]),_._v(" "),t("p",[_._v("R² 只能代表拟合的强弱，但不能说R² 越大模型越好，如何理解？看下面的例子：")]),_._v(" "),t("p",[t("img",{attrs:{src:s(383),alt:"img"}})]),_._v(" "),t("p",[_._v("从R²值中可以看出，上图中两个模型属于强拟合的情况，它们的 R² 值都>0.9")]),_._v(" "),t("p",[_._v("但很明显，尽管左侧模型具有更高的 R² 值，但右侧模型是更好的模型。左边的模型很差，因为它无法捕捉到数据的曲率。因此，高 R² 并不意味着模型很好，它只是意味着实际点与拟合点的平均偏差很小。")]),_._v(" "),t("p",[_._v("有时，模型可能具有较低的 R² 值，但实际上却是不错的模型。看下面的例子：")]),_._v(" "),t("p",[t("img",{attrs:{src:s(384),alt:"img"}})]),_._v(" "),t("p",[_._v("从上图中看出：")]),_._v(" "),t("ul",[t("li",[_._v("左侧模型的拟合度很差，但“拟合强度”适中")]),_._v(" "),t("li",[_._v("左侧模型与右侧模型相比，仅基于 R² 值，可能会认为最左侧的模型是更好的。这是错误的")]),_._v(" "),t("li",[_._v("再看中间模型，它的 R² 是右侧模型的三倍，并且从图中看出，似乎偏差不大，我们能否得出结论，中间模型比右侧型好得多？")])]),_._v(" "),t("p",[_._v("中间和图右侧图中的 "),t("strong",[_._v("数据点")]),_._v(" 基于同一条线 "),t("strong",[_._v("y=x+e")]),_._v("，其中 e 是服从正态分布随机生成的误差。它们之间的唯一区别是误差幅度在最右边的图表上被放大了")]),_._v(" "),t("p",[_._v("中间的模型红色的线实际上是如下模型：")]),_._v(" "),t("p",[t("strong",[_._v("y = 4.3.25*x-25")])]),_._v(" "),t("p",[_._v("右边的模型是正确的，它的模型方程为： "),t("strong",[_._v("y = x")]),_._v("，与生成数据点的线完全相同。")]),_._v(" "),t("p",[_._v("我们可以直观的看到，中间模型的直线有点儿偏")]),_._v(" "),t("p",[_._v("因此我们可以得出结论，具有低 R² 的模型仍然可以是好的模型，R² 较低的原因可能是数据方差较大")]),_._v(" "),t("p",[_._v("如果我们的目的是为了预测图中绘制出来的这部分数据点，那么中间模型可能会表现得更好，但这并不能说明中间的模型就是一个好模型（如果X取值增大，那么中间模型的误差会越来越大）")]),_._v(" "),t("p",[t("strong",[_._v("R² 小结")])]),_._v(" "),t("p",[_._v("R² 指标表明模型与测试数据的拟合程度，但无法解释模型是否良好")]),_._v(" "),t("p",[_._v("某些情况下，当增加模型复杂程度（比如添加高次方项），R²值会变大，单独以R²作为评价指标，可能会导致过拟合")]),_._v(" "),t("p",[_._v("R² 对非线性模型没有意义")]),_._v(" "),t("h3",{attrs:{id:"_2-adjusted-r2-adj-r2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-adjusted-r2-adj-r2"}},[_._v("#")]),_._v(" 2. Adjusted R² (Adj. R²)")]),_._v(" "),t("p",[_._v("介绍R²时我们提到，当增加模型复杂程度（比如添加高次方项），R²值会变大，单独以R²作为评价指标，可能会导致过拟合，我们可以通过Adj. R²来解决这个问题")]),_._v(" "),t("p",[t("img",{attrs:{src:s(385),alt:"img"}})]),_._v(" "),t("p",[_._v("上面的公式中，n 为样本数量，k 为模型中的自变量数，不包括常数项（截距）")]),_._v(" "),t("p",[_._v("比如："),t("strong",[_._v("y =a0 + a1*x1 + a2*x2")]),_._v("   对于这个模型 k = 2")]),_._v(" "),t("p",[t("strong",[_._v("为什么adjusted R-squared 比R-squared好？")]),_._v(" 接下来我们考虑如下两个模型：")]),_._v(" "),t("p",[t("strong",[_._v("y = x")])]),_._v(" "),t("p",[t("strong",[_._v("y = a0+a1*x1+a2*x²²+a3*x³³+a4*x⁴⁴+a5*x⁵⁵+a6*x⁶⁶+a7*x⁷⁷")])]),_._v(" "),t("p",[_._v("我们用上面两个模型分别拟合由 "),t("strong",[_._v("y=x+e")]),_._v(" 表示的数据，图形如下所示")]),_._v(" "),t("p",[t("img",{attrs:{src:s(386),alt:"img"}})]),_._v(" "),t("p",[_._v("如图上图所示：")]),_._v(" "),t("ul",[t("li",[_._v("左侧模型（有更多项高次方项）的 R² >右侧模型，单看R²指标左侧模型更好，但数据是基于 y=x+e 生成的")]),_._v(" "),t("li",[_._v("当我们查看Adjusted R² 值时，会发现最右边模型的R² 值 与 Adjusted R² 差值很小")]),_._v(" "),t("li",[_._v("左边模型R² 值 与 Adjusted R² 差值明显，说明左边模型过拟合了")])]),_._v(" "),t("p",[_._v("为了验证这个结论，依然使用 "),t("strong",[_._v("y=x+e")]),_._v("  产生数据，只不过重新生成一组随机数e ，再次用上面两个模型拟合新数据")]),_._v(" "),t("p",[t("img",{attrs:{src:s(387),alt:"img"}})]),_._v(" "),t("p",[_._v("从上面的结果中看出，新的数据中，简单模型的R² 值 与 Adjusted R² 都没有太明显的变化， 但是复杂模型的R² 值 与 Adjusted R² 都有明显的减小，说明复杂模型之所以在第一组数据集中表现良好，是因为拟合的是数据的噪声")]),_._v(" "),t("p",[_._v("因此，同时使用R²  与 Adjusted R² 可以更好的对模型是否过拟合做出判断，但更靠谱的办法还是使用多组不同的测试数据对模型进行测试。")]),_._v(" "),t("p",[t("strong",[_._v("Adjusted R² 小结")])]),_._v(" "),t("p",[_._v("通过Adjusted R² 可以在R² 的基础上对模型是否过拟合提供更多的信息")]),_._v(" "),t("h2",{attrs:{id:"_4-3-7-小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-7-小结"}},[_._v("#")]),_._v(" 4.3.7 小结")]),_._v(" "),t("p",[_._v("常用的回归问题的评估方法")]),_._v(" "),t("ul",[t("li",[_._v("MAE, MSE 和 RMSE")]),_._v(" "),t("li",[_._v("R²  与 Adjusted R²")])]),_._v(" "),t("p",[_._v("MAE, MSE 和 RMSE")]),_._v(" "),t("ul",[t("li",[_._v("RMSE会放大预测误差较大的样本的影响")]),_._v(" "),t("li",[_._v("MAE对误差大小不敏感")]),_._v(" "),t("li",[_._v("RMSE对异常数据敏感")])]),_._v(" "),t("p",[_._v("R²  与 Adjusted R²")]),_._v(" "),t("ul",[t("li",[_._v("R²<0.5 → 弱拟合")]),_._v(" "),t("li",[_._v("0.5 ≤ R² ≤ 0.8 → 中度拟合")]),_._v(" "),t("li",[_._v("R² > 0.8 强拟合")])]),_._v(" "),t("p",[_._v("不能单独通过R²的大小来判断模型好坏，可以通过配合Adjusted R² 和 多用不同的测试数据来修正R²的不足")])])}),[],!1,null,null,null);t.default=v.exports}}]);